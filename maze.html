<!DOCTYPE html><html><head><style>html,#g{background:#334}body{margin:0 auto;max-width:42em;padding:1em;color:#eee}</style><title>Maze</title></head><body><h1>Maze</h1><p>Game size is 1319 bytes</p><canvas id="g" width="639" height="369"></canvas><script>f="fillRect";e="clearRect";g=document.getElementById("g");c=g.getContext("2d");c.fillStyle="#eee";F=Math.floor;r=i=>F(i*Math.random());a=(i,f)=>[...Array(i)].map(_=>f());t=a(72,_=>a(42,_=>{}));h=[-1,0];j=[0,-1];k=[0,1];l=[1,0];p=o=>o.n?o.n=p(o.n):o;P=(x,y)=>t[x][y]=p((o=t[x][y])?o:{});a=i=>1+2*r(i);n=(x,y,z,w)=>(z=P(z,w),x=P(x,y),z!=x?z.n=x:1);I=9;while(P(1,1)!=P(69,39)|P(1,39)!=P(69,1)){x=a(35);y=a(20);P(x,y);[z,w]=r(2)?r(2)?x<2?l:h:y<2?k:j:r(2)?y>38?j:k:x>68?h:l;P(x,y)!=P(x+2*z,y+2*w)||!t[x+z][y+w]&&I-->0?t[x+z][y+w]=n(x,y,x+2*z,y+2*w):0}t[x=1][y=0]={};t[69][40]={};t.map((t,x)=>t.map((v,y)=>v?c[f](9*x,9*y,9,9):0));u=f=>c[f](9*x+2,9*y+2,5,5);u(e);d=(a,b)=>a>b-2&a<b+2;g.addEventListener("mousemove",v=>{z=F(v.offsetX/9);w=F(v.offsetY/9);t[x][y]?u(f):0;x==z?y>w?t[x][y-1]?y--:0:y<w&&t[x][y+1]?y++:0:y==w?x>z?t[x-1][y]?x--:0:x<z&&t[x+1][y]?x++:0:0;u(e)});B=[[1,39],[69,1]];window.setInterval(_=>{T=B;B=[];T.forEach(([x,y])=>{t[x][y]=0;c[e](9*x,9*y,9,9);a=([z,w])=>{z+=x;w+=y;w<40&&t[z][w]?B.push([z,w]):0};a(h);a(j);a(k);a(l)})},1e3)</script></body></html>
